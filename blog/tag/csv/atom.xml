<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>https://jnrowe.github.io/</id>
  <title>JNRowe - Posts tagged csv</title>
  <updated>2009-10-10T00:00:00+01:00</updated>
  <link href="https://jnrowe.github.io/"/>
  <link href="https://jnrowe.github.io/blog/tag/csv/atom.xml" rel="self"/>
  <generator uri="https://ablog.readthedocs.org/" version="0.10.23">ABlog</generator>
  <subtitle>Ramblings of a tired mind</subtitle>
  <entry>
    <id>https://jnrowe.github.io/articles/tips/Formatting_csv_files_in_the_shell.html</id>
    <title>Formatting CSV files in the shell</title>
    <updated>2009-10-10T00:00:00+01:00</updated>
    <author>
      <name>James Rowe</name>
    </author>
    <content type="html">&lt;section id="formatting-csv-files-in-the-shell"&gt;

&lt;p&gt;kemi asks in &lt;code class="docutils literal notranslate"&gt;&lt;span class="pre"&gt;#bash&lt;/span&gt;&lt;/code&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;div&gt;&lt;p&gt;Are there any tools to format &lt;abbr title="Comma Separated Values"&gt;CSV&lt;/abbr&gt; files in the console?  Not
interactive, no spreadsheets&lt;/p&gt;
&lt;/div&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.linuxmanpages.com/man1/column.1.php"&gt;column&lt;/a&gt;, which on Linux is likely to be provided by &lt;a class="reference external" href="http://www.kernel.org/pub/linux/utils/util-linux-ng/"&gt;util-linux&lt;/a&gt;, does exactly
this.  The man page even offers an example of how it works(Iâ€™ve changed it
slightly to make it work correctly on my system):&lt;/p&gt;
&lt;div class="highlight-console notranslate"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PERM LINKS OWNER GROUP SIZE DATE HH:MM NAME&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&lt;/span&gt;     ls -l static/ &lt;span class="p"&gt;|&lt;/span&gt; sed 1d&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; column -t
&lt;span class="go"&gt;PERM        LINKS  OWNER  GROUP  SIZE   DATE        HH:MM  NAME&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    328    2009-09-25  02:59  body_background.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    7234   2009-09-25  02:59  draft.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    6253   2009-09-25  02:59  extract-metadata.xsl&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    13143  2009-10-07  09:05  foaf.rdf&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    3580   2009-09-25  02:59  gpg.asc&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    7739   2009-09-25  02:59  icon.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    96     2009-09-25  02:59  meta_background.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    411    2009-09-29  11:39  remote.png&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Given some other standard commands we can mangle that data in various ways at
the shell prompt too, for example we may wish to display the total size of all
the files.  Or, as in the output below, the total size of all the &lt;abbr title="Portable Network Graphics"&gt;PNG&lt;/abbr&gt; files in the directory.&lt;/p&gt;
&lt;div class="highlight-console notranslate"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PERM LINKS OWNER GROUP SIZE DATE HH:MM NAME&amp;quot;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&lt;/span&gt;     ls -l static/ &lt;span class="p"&gt;|&lt;/span&gt; sed 1d&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; column -t &lt;span class="p"&gt;|&lt;/span&gt; awk &lt;span class="s1"&gt;&amp;#39;{print}&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&lt;/span&gt;&lt;span class="s1"&gt;         /\.png/ {sum+=$5}&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&lt;/span&gt;&lt;span class="s1"&gt;         END {print &amp;quot;Total size of PNG files:&amp;quot;, sum}&amp;#39;&lt;/span&gt;
&lt;span class="go"&gt;PERM        LINKS  OWNER  GROUP  SIZE   DATE        HH:MM  NAME&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    328    2009-09-25  02:59  body_background.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    7234   2009-09-25  02:59  draft.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    6253   2009-09-25  02:59  extract-metadata.xsl&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    13143  2009-10-07  09:05  foaf.rdf&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    3580   2009-09-25  02:59  gpg.asc&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    7739   2009-09-25  02:59  icon.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    96     2009-09-25  02:59  meta_background.png&lt;/span&gt;
&lt;span class="go"&gt;-rw-r--r--  1      jay    jay    411    2009-09-29  11:39  remote.png&lt;/span&gt;
&lt;span class="go"&gt;Total size of PNG files: 15808&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;In the original question on how to process &lt;abbr title="Comma Separated Values"&gt;CSV&lt;/abbr&gt; files all we really need to
do is get the data in to a state for &lt;strong class="command"&gt;column&lt;/strong&gt; to process, and we can
use &lt;a class="reference external" href="http://www.linuxmanpages.com/man1/tr.1.php"&gt;tr&lt;/a&gt; to do that.  An example using a small chunk of the network log on this
computer that we wish to format and calculate totals for could be:&lt;/p&gt;
&lt;div class="highlight-console notranslate"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; cat stats
&lt;span class="go"&gt;2009-07-15T05:09:42+0100,16803,4304661,129262665&lt;/span&gt;
&lt;span class="go"&gt;2009-07-16T04:10:29+0100,17551,4012917,67572304&lt;/span&gt;
&lt;span class="go"&gt;2009-07-16T19:03:00+0100,17621,1712073,34162500&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T14:18:19+0100,7961,1071313,26286593&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T18:23:40+0100,1867,308589,6057915&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T18:53:21+0100,1740,180197,2907388&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T19:00:03+0100,356,152917,928948&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T22:01:57+0100,6611,1159789,25562873&lt;/span&gt;
&lt;span class="go"&gt;2009-07-18T13:09:31+0100,1681,164663,2049315&lt;/span&gt;
&lt;span class="go"&gt;2009-07-18T13:24:04+0100,834,54025,662134&lt;/span&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Date,Duration,Sent,Received&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  cat stats &lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&amp;gt;     &lt;span class="p"&gt;|&lt;/span&gt; tr &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; column -t &lt;span class="p"&gt;|&lt;/span&gt; awk &lt;span class="s1"&gt;&amp;#39;{print}&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&lt;/span&gt;&lt;span class="s1"&gt;         !/Date/ {sent+=$3; recv+=$4}&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&lt;/span&gt;&lt;span class="s1"&gt;         END {print &amp;quot;\nTotal sent: &amp;quot;sent&amp;quot;, Total received: &amp;quot;recv}&amp;#39;&lt;/span&gt;
&lt;span class="go"&gt;Date                      Duration  Sent     Received&lt;/span&gt;
&lt;span class="go"&gt;2009-07-15T05:09:42+0100  16803     4304661  129262665&lt;/span&gt;
&lt;span class="go"&gt;2009-07-16T04:10:29+0100  17551     4012917  67572304&lt;/span&gt;
&lt;span class="go"&gt;2009-07-16T19:03:00+0100  17621     1712073  34162500&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T14:18:19+0100  7961      1071313  26286593&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T18:23:40+0100  1867      308589   6057915&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T18:53:21+0100  1740      180197   2907388&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T19:00:03+0100  356       152917   928948&lt;/span&gt;
&lt;span class="go"&gt;2009-07-17T22:01:57+0100  6611      1159789  25562873&lt;/span&gt;
&lt;span class="go"&gt;2009-07-18T13:09:31+0100  1681      164663   2049315&lt;/span&gt;
&lt;span class="go"&gt;2009-07-18T13:24:04+0100  834       54025    662134&lt;/span&gt;

&lt;span class="go"&gt;Total sent: 13121144, Total received: 295452635&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;
</content>
    <link href="https://jnrowe.github.io/articles/tips/Formatting_csv_files_in_the_shell.html" rel="alternate"/>
    <summary>kemi asks in #bash:</summary>
    <category term="csv" label="csv"/>
    <category term="unix" label="unix"/>
    <published>2009-10-10T00:00:00+01:00</published>
  </entry>
</feed>
