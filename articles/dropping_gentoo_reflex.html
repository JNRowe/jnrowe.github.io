
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Dropping Gentoo reflex &#8212; JNRowe</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="fossil experiments" href="fossil.html" />
    <link rel="prev" title="Dropping Gentoo" href="dropping_gentoo.html" />
  
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
  <link rel="alternate" type="application/atom+xml"  href="../blog/atom.xml" title="JNRowe">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="dropping-gentoo-reflex">
<h1>Dropping Gentoo reflex<a class="headerlink" href="#dropping-gentoo-reflex" title="Permalink to this headline">¶</a></h1>
<p>After hitting the publish button on <a class="reference internal" href="dropping_gentoo.html"><span class="doc">Dropping Gentoo</span></a> a few friends
commented that I was either unnecessarily harsh about Gentoo or we wasted an
enormous amount of time on it.  It definitely was the former, and I feel
a touch ashamed for implying the latter.</p>
<p>I was writing my thoughts in the “project obituary” form that I’m used to, and
that is entirely about spotting the downsides to make sure they don’t reoccur.
And with that in mind I <em>was</em> being incredibly unfair to Gentoo, both the
project and by extension the people working on it.</p>
<p>There were many, many good points about Gentoo and I’ll nod towards a few now.</p>
<div class="section" id="speed">
<h2>Speed<a class="headerlink" href="#speed" title="Permalink to this headline">¶</a></h2>
<p>No, no.  Not the “Oh my god, my KDEs are so fast” that many people fairly
associate with Gentoo users.  I’m talking about the basic package handling
tasks.</p>
<p>There are very few other distributions that can match Gentoo when it comes to
the speed of editing a package.  Or, for that matter, the speed of installation
if you share binary packages.</p>
<p>Almost the first thing you notice when switching to Debian or Fedora as a heavy
binary package user on Gentoo is just how slow package installation and removal
is.  Binary package installation on Gentoo feels on par with a distribution
like Slackware, and what passes for package management there is just choosing
the right argument to <strong class="command">tar</strong>’s <code class="xref std std-option docutils literal notranslate"><span class="pre">-C</span></code> option.</p>
<p>Where Gentoo really excels though is in the speed of creating new packages or
editing existing packages.</p>
<p>Lets take a look at an example.  Say, for example, that you just found out that
<code class="docutils literal notranslate"><span class="pre">flask-dashed</span></code>’s  <code class="docutils literal notranslate"><span class="pre">ebuild</span></code> mistakenly installs a <code class="file docutils literal notranslate"><span class="pre">/usr/README</span></code> file.
We we can fix the problem with the following simple change and a call to
<code class="docutils literal notranslate"><span class="pre">repoman</span> <span class="pre">manifest</span></code>, the rest takes care of itself.</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --git i/flask-dashed-0.1b_p2.ebuild w/flask-dashed-0.1b_p2.ebuild</span>
<span class="gh">index dd64877a387e..cf3e3cbf272b 100644</span>
<span class="gd">--- i/flask-dashed-0.1b_p2.ebuild</span>
<span class="gi">+++ w/flask-dashed-0.1b_p2.ebuild</span>
<span class="gu">@@ -29,5 +29,6 @@ S=&quot;${WORKDIR}/${MY_P}&quot;</span>

 src_prepare() {
        distutils-r1_src_prepare
<span class="gi">+       sed -i /data_files/d setup.py || die &quot;sed failed&quot;</span>
        rm -rf &quot;${S}/tests&quot;
}
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Of course, you should fix the package properly and send the fix upstream but
this is just to prove a point.  Calling <strong class="command">die</strong> with <strong class="command">sed</strong>
there isn’t recommended and is practically pointless, but it is the style
upstream.</p>
</div>
<p>I have to mention a small downside here however, because very few people seem to
test <code class="docutils literal notranslate"><span class="pre">portage</span></code>’s binary package support you’ll occasionally have to do some
leg work to fix problems.  This normally arises when you have an <code class="docutils literal notranslate"><span class="pre">eclass</span></code>
change that needs to ripple through, or when a library breaks compatibility and
its <code class="docutils literal notranslate"><span class="pre">ebuild</span></code> hasn’t been bumped properly.</p>
<p>Almost every time that happens you can fix it with a quick loop in your shell
though.  A couple of such problems and solutions that I found in my shell
history can be seen below.</p>
<div class="highlight-zsh notranslate"><div class="highlight"><pre><span></span><span class="c1"># When you were stuck with packages that used python-distutils-ng, and you</span>
<span class="c1"># needed to scrub packages because you changed Python version</span>
<span class="k">for</span> p in <span class="k">$(</span>portageq pkgdir<span class="k">)</span>/*-*/*.tbz2<span class="p">;</span> <span class="k">do</span>
    qtbz2 -xO <span class="nv">$p</span> <span class="p">|</span> qxpak -xO - <span class="si">${${</span><span class="nv">p</span><span class="p">##*/</span><span class="si">}</span><span class="p">/.tbz2</span><span class="si">}</span>.ebuild <span class="p">|</span> grep -q <span class="s1">&#39;SUPPORT_PYTHON_ABIS&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="nv">$p</span>
<span class="k">done</span>

<span class="c1"># When you were using packages that used python’s “-r1” eclasses and all</span>
<span class="c1"># you could see is a flood of blockages in your update output</span>
<span class="k">for</span> p in <span class="k">$(</span>portageq pkgdir<span class="k">)</span>/*-*/*.tbz2<span class="p">;</span> <span class="k">do</span>
    qtbz2 -xO <span class="nv">$p</span> <span class="p">|</span> qxpak -xO - RDEPEND <span class="m">2</span>&gt;/dev/null <span class="p">|</span> grep -q <span class="s2">&quot;dev-python/python-exec&quot;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="nv">$p</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>The excellent <a class="reference external" href="http://devmanual.gentoo.org/">devmanual</a> and the incredible <a class="reference external" href="http://wiki.gentoo.org/wiki/Project:PMS">Package Manager Specification</a>
made life so much easier.  The devmanual was both short enough to be used as
quick reference and complete enough that you could learn most of what you’d need
to know from it.  The unfortunately named <abbr title="Package Manager Specification">PMS</abbr> acted as the reference that
finally allowed us to switch from away from <code class="docutils literal notranslate"><span class="pre">portage</span></code> completely at the
office.</p>
<p>The <abbr title="Package Manager Specification">PMS</abbr> documented much of the nastiness that <code class="docutils literal notranslate"><span class="pre">portage</span></code> suffers from, and
made life in general a whole lot nicer when you were chasing bugs deep down the
rabbit hole.  And, let us be honest here it also stopped a little of the
fluidity that plagued <code class="docutils literal notranslate"><span class="pre">portage</span></code> too.</p>
<p>Some people argue that it acts as unnecessary stop motion but those people must
be forgetting what happened when behaviour changed randomly between <code class="docutils literal notranslate"><span class="pre">portage</span></code>
versions.  <abbr title="Package Manager Specification">PMS</abbr>, and the EAPI process, also brought some much needed design
and stability to newer features.</p>
<p>All Gentoo users owe Ciaran McCreesh a few beers for all the hard work he put in
to those documents, especially in the early days.</p>
</div>
<div class="section" id="the-personal-touch">
<h2>The personal touch<a class="headerlink" href="#the-personal-touch" title="Permalink to this headline">¶</a></h2>
<p>On a personal note I’ve met some awesome people over the years as a result of
using Gentoo.  Many of them at the old Gentoo UK conferences, which were always
fun.  More recently at LoFu’s annual summit which seems to have taken Gentoo
UK’s place with practically everyone you saw at Gentoo UK(minus the students),
and oddly about the same Gentoo to non-Gentoo ratio of talks too.</p>
<p>Two excellent people on our current team were recruited following the Gentoo UK
conference at <abbr title="University College London">UCL</abbr>, and we met a spectacular
contract hire at the one prior to that as well.</p>
<p>I’ve even been lucky enough to have a few doors held open for me via people I’ve
met at Gentoo-themed or Gentoo-heavy events, and I suspect I’d be writing this
from a less happy place without them.</p>
</div>
<div class="section" id="wrapping-up">
<h2>Wrapping up<a class="headerlink" href="#wrapping-up" title="Permalink to this headline">¶</a></h2>
<p>It is true that you really can not always see the forest for trees.</p>
<p>Had recent events not clouded my vision I would have commented on the train
wreck that is <code class="file docutils literal notranslate"><span class="pre">webapp.eclass</span></code> and <code class="file docutils literal notranslate"><span class="pre">app-admin/webapp-config</span></code> in
<a class="reference internal" href="dropping_gentoo.html"><span class="doc">Dropping Gentoo</span></a>.  It sucked tonnes and tonnes of time away until we
eventually just trashed any package that interacted with it and moved on.</p>
<p>That was so long ago that I had forgotten about it until a co-worker asked me
why I hadn’t mentioned it.  I suspect most of the other negative comments I made
will feel equally inconsequential when compared to the benefits Gentoo gave us
as time moves on.</p>
<p>Instead of making this rant even longer, I’ll take the time to reflect on the
fun memories.</p>
</div>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  Previous: 
  <a href="dropping_gentoo.html">
    
    Dropping Gentoo
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  Next: 
  <a href="probits/index.html">
    Project postmortems
    
  </a>
  </span>
  
</div>

  
  
  </div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>









  
  
  <h2>
  
  
    2014-06-29
  
  </h2>

  <ul>
    

  

  

  

  

  
  <li id="tags"><span>Tags:</span>
      
    
      
      <a href="../blog/tag/gentoo.html">gentoo</a>
      
    
      
      <a href="../blog/tag/work.html">work</a>
      
    
      
      <a href="../blog/tag/linux.html">linux</a>
      
    </li>
  
  
  </ul>


<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Projects</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Articles</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dropping_gentoo.html">Dropping Gentoo</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Dropping Gentoo reflex</a></li>
<li class="toctree-l2"><a class="reference internal" href="fossil.html"><strong class="command">fossil</strong> experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="mutt_config_snippets.html"><strong class="command">mutt</strong> configuration snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="rcs.html">Introduction to <abbr title="GNU Revision Control System">RCS</abbr></a></li>
<li class="toctree-l2"><a class="reference internal" href="tdd_distros.html"><abbr title="Test Driven Development">TDD</abbr> distro development</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#further-categories">Further categories</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../thoughts/index.html">Thoughts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../colophon.html">Colophon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../consult.html">Consulting services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>


  <h3><a href="../blog.html">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../thoughts/brexit_through_the_gift_shop.html">08 June - brexit through the gift shop</a></li>
    
      <li><a href="../thoughts/metro_city.html">03 September - Burning down the streets</a></li>
    
      <li><a href="fossil.html">12 November - fossil experiments</a></li>
    
      <li><a href="../thoughts/disconnect.html">18 September - Cleanse thy soul</a></li>
    
      <li><a href="../thoughts/burn_out.html">03 September - Open Source and enjoyment</a></li>
    
  </ul>

  <h3><a href="../blog/tag.html">Tags</a></h3>
  <style type="text/css">
    ul.ablog-cloud {list-style: none; overflow: auto;}
    ul.ablog-cloud li {float: left; height: 20pt; line-height: 18pt; margin-right: 5px;}
    ul.ablog-cloud a {text-decoration: none; vertical-align: middle;}
    li.ablog-cloud-1{font-size: 80%;}
    li.ablog-cloud-2{font-size: 95%;}
    li.ablog-cloud-3{font-size: 110%;}
    li.ablog-cloud-4{font-size: 125%;}
    li.ablog-cloud-5{font-size: 140%;}
  </style>
  <ul class="ablog-cloud">
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/gtk.html">GTK+</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/x11.html">X11</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/abook.html">abook</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/awesome.html">awesome</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/bash.html">bash</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/blog.html">blog</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/bts.html">bts</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/bugzilla.html">bugzilla</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/burnout.html">burnout</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/configs.html">configs</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/csv.html">csv</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/denoise.html">denoise</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/devel.html">devel</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/development.html">development</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/emacs.html">emacs</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/focus.html">focus</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/fossil.html">fossil</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-4">
        <a href="../blog/tag/gentoo.html">gentoo</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/git.html">git</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/gmail.html">gmail</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/history.html">history</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/hobbies.html">hobbies</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/jnrowe-misc.html">jnrowe-misc</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../blog/tag/life.html">life</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/linux.html">linux</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/mail.html">mail</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/mutt.html">mutt</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/net.html">net</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/noise.html">noise</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/oss.html">oss</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/politics.html">politics</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/privacy.html">privacy</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/probit.html">probit</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/projects.html">projects</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/python.html">python</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/readline.html">readline</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/remind.html">remind</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/site.html">site</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/software.html">software</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../blog/tag/styling.html">styling</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/sup.html">sup</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/testing.html">testing</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/three.html">three</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../blog/tag/unix.html">unix</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-4">
        <a href="../blog/tag/vcs.html">vcs</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/vim.html">vim</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/web.html">web</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/work.html">work</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/zsh.html">zsh</a></li>
      
    
  </ul>

  <h3><a href="../blog/archive.html">Archives</a></h3>
  <ul>
  
    
    <li><a href="../blog/2018.html">2018 (1)</a></li>
    
  
    
    <li><a href="../blog/2017.html">2017 (1)</a></li>
    
  
    
    <li><a href="../blog/2014.html">2014 (12)</a></li>
    
  
    
    <li><a href="../blog/2013.html">2013 (2)</a></li>
    
  
    
    <li><a href="../blog/2011.html">2011 (1)</a></li>
    
  
    
    <li><a href="../blog/2010.html">2010 (1)</a></li>
    
  
    
    <li><a href="../blog/2009.html">2009 (24)</a></li>
    
  
    
    <li><a href="../blog/2007.html">2007 (2)</a></li>
    
  
    
    <li><a href="../blog/2003.html">2003 (1)</a></li>
    
  
  </ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2009-2018  James Rowe.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>